<!-- .slide: id="84847c8ea82d" -->
# In 2019

Notes:
- Let me tell you a story..
- In 2019

;VS;
<!-- .slide: id="e8a04bbe011d" -->
![packt](assets/images/packt.png)

### reached out to me for a video course
### on IONIC <!-- .element class="fragment" -->

Notes:
- one of the biggest publishers (Packt) reached out and asked if I wanted to create a video course for them
- On IONIC. 
- How many of you have worked with IONIC? 
- Ooh. That’s awesome!

;VS;
<!-- .slide: id="18c7fef6645c" -->
 

### And I thought. That's super cool

![awesome](assets/images/monorepo-with-nx/awesome.webp)

Notes:
- I've always wanted to create professional video courses for others. 
- Inspired by great tutors like John Papa, and Todd Motto.

;VS;
<!-- .slide: id="c6ee2fb0b825" -->
 

# But...

Notes:
- Surprise!!

;VS;
<!-- .slide: id="4b3960c5b4e1" -->

### I used to live with my family back then

![joint-family](assets/images/monorepo-with-nx/joint-family.webp)

Notes:
- That is I lived in a joint-family system. 
- And that’s pretty common in Pakistan
- And is much preferred as well.
- However, you usually only had one room to yourself in such a setup

;VS;
<!-- .slide: id="0445e5c1526b" -->
 

### And used to record the videos at night

![recording at night](assets/images/monorepo-with-nx/recording-at-night.webp)

;VS;
<!-- .slide: id="7135484514a1" -->
 

### I faced some challenges

;VS;
<!-- .slide: id="fed3bfcdce6b" -->
 
<!-- .element data-transition="none" -->

![recording at night](assets/images/monorepo-with-nx/recording-at-night.webp)

Notes:
- First of all, my room had almost no furniture and I was just married.
- Even the slightest sound in the room would've been captured in the recordings.
- There have been instances when the slightest sound of  my wife’s turns on the bed while she’s sleeping would piss me off.


;VS;
<!-- .slide: id="7a237816d3e2" -->
 
<!-- .element data-transition="none" -->

### I then tried to record from the living room...

![recording in living room](assets/images/monorepo-with-nx/recording-living-room.webp)

Notes:
- So I went outside in the living room to record in peace.
- But that had a window to the frontside of the house
- And I would often hear

;VS;
<!-- .slide: id="3338012fc283" data-transition="none" -->
 
<video style="max-width: 100%; max-height: 100%" data-autoplay src="assets/videos/monorepo-with-nx/rooster.mp4"></video>

Notes:
- Roosters
- Or...

;VS;
<!-- .slide: id="8096ac0cf7f1" data-transition="none" -->
 
<video style="max-width: 100%; max-height: 100%" data-autoplay src="assets/videos/monorepo-with-nx/bike.mp4"></video>

Notes:
- Bikes going around

;VS;
<!-- .slide: id="eeaf74896993" data-transition="none" -->
 
<video style="max-width: 100%; max-height: 100%" data-autoplay src="assets/videos/monorepo-with-nx/screaming.mp4"></video>

Notes:
- And that resulted in a lot of frustration

;VS;
<!-- .slide: id="bbb4eb620658" -->

## Fortunately, I moved to Sweden

;VS;
<!-- .slide: id="7fb11a97a69a" data-transition="none" -->
 
![sweden](assets/images/monorepo-with-nx/happiness.jpg)

;VS;
<!-- .slide: id="19efaf2c7220" -->
 

### Once I published the video course, I thought...

;VS;
<!-- .slide: id="2b6b7451c0d2" -->
 

![rich](assets/images/monorepo-with-nx/dreaming-rich.webp)

;VS;
<!-- .slide: id="f5374431d2f8" -->
 

## However...
#### It was the time when ...

;VS;
<!-- .slide: id="e430867023e1" -->
 

![react-native](assets/images/monorepo-with-nx/react-native-ionic.png)

Notes:
- React Native came out
- People started using React Native more
- And my course didn't sell as well as we thought

;HS;

<!-- .slide: id="e4e2b6d22830" -->

# In 2020

;VS;
<!-- .slide: id="1258581ffd79" -->
![packt](assets/images/packt.png)

### asked me if I would be interested in writing a book on Angular

;VS;
<!-- .slide: id="ee2861ce4e2a" -->

### Long story short

#### It took over 10 months <!-- .element class="fragment" -->
![ng-cookbook](assets/images/ng-book-cover.png) <!-- .element style="height: 200px" -->
#### And we sold 2000+ copies over the years <!-- .element class="fragment" -->

;HS;

# In late 2022

;VS;

<!-- .slide: id="5451776ee2cc" -->
 

![packt](assets/images/packt.png)

### reached out for authoring the `2nd edition` of the book

;VS;
<!-- .slide: id="7403bb8a83e2" -->
 

### At first, I thought it would be easy

Notes:
- At first, I thought this would be an easy win
- I thought, "it is just an updated version of the book, right".
- I mean most of it would remain the same.

;VS;
<!-- .slide: id="a71b3d19091f" -->
 

### But when I looked at the code base,
### I knew I was in trouble <!--.element class="fragment" -->

;VS;
<!-- .slide: id="6a68a599c6af" -->
 

### 150+ projects

<div style="display: flex; gap: 16px; align-items: center; justify-content: space-around;">
  <img style="max-width: 50%;
    width: max-content;
    object-fit: cover;
    max-height: 100%;
    height: 400px;
    margin: 0;" src="assets/images/angular-schematics/80-projects.gif">
  <img style="max-width: 50%;
    width: max-content;
    object-fit: cover;
    max-height: 100%;
    height: 400px;
    margin: 0;" src="assets/images/angular-schematics/80-projects.gif">
</div>

Notes:
- I saw 150+ projects
- Angular projects

;VS;
<!-- .slide: id="72b926fdb958" -->
 

### Waiting to be updated

![v7 to v16](assets/images/monorepo-with-nx/v7-v16.png)

Notes:
- From v12 to v17
- And if you know, the ideal way is to update from one major version to another, at a time.

;VS;
<!-- .slide: id="04eab0241569" -->
 

![slow-motion](assets/images/angular-schematics/ng-release-cycle.png) <!-- .element: style="height: 500px;" -->

;VS;
<!-- .slide: id="7dfea006220c" -->
 

## Updating all the recipes

![slow-motion](assets/memes/slow-motion.gif) <!-- .element: style="height: 500px;" class="fragment" -->


Source: https://angular.dev/reference/releases

;VS;
<!-- .slide: id="9138783abef8" -->

## So what did I do?

![NX](https://raw.githubusercontent.com/nrwl/nx/master/images/nx-dark.svg) <!-- .element: class="fragment" -->
Notes:
- So what did I do?
- I was fortunate enough to stumble upon NX.
- One of the best ways to work with a monorepo/workspace hosting multiple applications

;VS;
<!-- .slide: id="b5481d475969" -->
 

###### I decided to have 1 monorepo with 2 Nx workspaces. 

![80-to-2.gif](assets/images/monorepo-with-nx/to-nx-ws.gif) <!-- .element: style="height: 500px;" class="fragment" -->
One for the `starter` files and the other containing the `final` codes for the recipes
;VS;
<!-- .slide: id="865b0e34e59d" -->
 

![nx-monorepo](assets/images/angular-schematics/nx-monorepo.png) <!-- .element: style="height: 500px;" -->

Notes:
- I planned it to look like this.
- Having 1 monorepo
- Inside, two NX workspaces
- Each workspace having chapters, and inside, the recipes

;VS;

<!-- .slide: id="8b55864d421b" -->
![question](assets/images/monorepo-with-nx/question.webp) 

;VS;
<!-- .slide: id="694516e6989b" -->

- How many of you love UI/UX?
- How many of you advocate for great UI/UX?
<!-- .element: class="fragment" -->

- How many of you advocate for great `Developer Experience` (DX)?
<!-- .element: class="fragment" -->

Notes:
- Can I have a show of hands?
- Now that's what my focus was for the book.
- Not only a great DX for the readers, but for myself as well.

;VS;

<!-- .slide: id="b6cae7af772f" -->

## With the current NX structure

<div style="display: flex; gap: 16px; align-items: center; justify-content: space-around;">
  <img style="max-width: 50%;
    width: max-content;
    object-fit: cover;
    max-height: 100%;
    height: 400px;
    margin: 0;" src="assets/images/angular-schematics/nx-monorepo.png">
  <img style="max-width: 50%;
    width: max-content;
    object-fit: cover;
    max-height: 100%;
    height: 400px;
    margin: 0;" src="assets/images/monorepo-with-nx/ws-structure.png">
</div>

;VS;
<!-- .slide: id="aa72b55fb9fd" -->
#### To run any recipe, the reader would have to run:

```bash
cd start
nx serve chapter01-cc-ng-on-changes
```

;VS;
<!-- .slide: id="f25d009d0c78" -->
 

```bash
cd start && npx nx g @nrwl/angular:application chapter01/cc-ng-on-changes
```
The above generates an app with the name 

*`chapter01-cc-ng-on-changes`*
<!-- .element: style="color: yellow;" -->

;VS;
<!-- .slide: id="dd33e4b22ec3" -->
 

Which means, my book's readers would have to write the `chapter name` and `app name` to serve the app:

*`npm run serve chapter01-cc-ng-on-changes`*
<!-- .element: style="color: yellow;" -->

;VS;
<!-- .slide: id="b1440aeae9eb" -->
 


![thinking-maths](assets/memes/thinking-maths.gif) <!-- .element: style="height: 500px;" -->


Notes:
- And now I have to always provide the chapter name along with the recipe name...all the time
- Can we do better?

;VS;
<!-- .slide: id="fc6ff6e05671" -->
 

## Can we do better?

;VS;
<!-- .slide: id="43656084f0f7" -->
 

### What are the possibilities?
 
##### Can we exclude the `chapter name` from the project's name? 

<!-- .element: class="fragment" -->

#### OR <!-- .element: class="fragment" -->

##### Can we rename the project *after* it has been created? <!-- .element: class="fragment" -->

;HS;


# @nrwl/nx-plugin

;VS;
<!-- .slide: id="c1ebb8c6d306" -->
 

I ended up creating an NX plugin to `rename` the app after it has been created

;VS;
<!-- .slide: id="58b5850c1e04" -->
 

#### The plugin contained two counterparts

![nx-plugin](assets/images/angular-schematics/nx-plugin.png)

;VS;
<!-- .slide: id="d5c186d07bdd" -->
 

![Generator purpose](assets/images/angular-schematics/generator-purpose.png)  <!-- .element: style="height: 500px;" -->

;VS;
<!-- .slide: id="2d7c59992ab5" -->
 

<small>@codewithahsan/.../generators/ng-cookbook-recipe/generator.ts</small>

![Generator code](assets/images/angular-schematics/generator.png) 

;VS;
<!-- .slide: id="4a68d7f3d80b" -->
 
<small>@codewithahsan/.../generators/ng-cookbook-recipe/generator.ts</small>


![Generator code example](assets/images/angular-schematics/generator-exp.png) 

;VS;
<!-- .slide: id="4886236d8ef8" -->
 

![Generator code generated](assets/images/angular-schematics/generator-project-code.png) 

;VS;
<!-- .slide: id="8fead060cdc2" -->
 

![Executor purpose](assets/images/angular-schematics/executor-purpose.png)  <!-- .element: style="height: 500px;" -->

;VS;
<!-- .slide: id="3a86e71d4e98" -->
 
<small>@codewithahsan/.../executors/rename/executor.ts</small>


![Generator code example](assets/images/angular-schematics/executor-code.png) <!-- .element: style="position: relative; bottom: 60px; scale: 0.85;" -->

;VS;
<!-- .slide: id="52eff4a94792" -->
 
<small>App generation process in a nutshell (for me)</small>


![App Generation Process](assets/images/angular-schematics/app-generation-process.png) 

;VS;
<!-- .slide: id="ee7cd3738200" -->
 

#### Let's disect the command to understand better

![Create command explanation](assets/images/angular-schematics/run-create-command.png) 

;VS;
<!-- .slide: id="4893c0589055" -->
 


#### The bash script that creates all the projects in a consistent manner

```bash
# code stripped for conciseness

cd "start" && npx nx g @codewithahsan/ng-cookbook-recipe:ng-cookbook-recipe \
"$APP_NAME" --title="$APP_TITLE" --directory="$CHAPTER" --style scss \
--routing --e2eTestRunner none --skipDefaultProject --addTailwind

npx nx run "$APP_FULL_NAME:rename"
```

;VS;
<!-- .slide: id="bf731ac2c998" -->
 

## The target project structure

![target project structure](assets/images/angular-schematics/folder-structure.png) 


;VS;
<!-- .slide: id="2a0154594533" -->
 

All of this is to be able to run this from the root of my git repository:

```shell
npm run serve cc-ng-on-changes
```
<!-- .element: class="fragment" -->

OR... to run both the start and final apps
<!-- .element: class="fragment" -->

```shell
npm run serve cc-ng-on-changes both
```
<!-- .element: class="fragment" -->

;HS;


# Another Problem! ⚠️

;VS;
<!-- .slide: id="d70335cb104b" -->
 

## Inconsistent styles and layouts across multiple recipes

;VS;
<!-- .slide: id="bdd28000f157" -->
 

![App Layout](assets/images/angular-schematics/app-layout.png) 

;VS;
<!-- .slide: id="3a18f0c7b0be" -->
 

![App Layout](assets/images/angular-schematics/app-layout-2.png) 

;VS;
<!-- .slide: id="2a7f98a24d75" -->
 

## Solution? 🤔

;VS;
<!-- .slide: id="a305bb0b73b3" -->
 

![nx lib and generator](assets/images/angular-schematics/lib-and-gen.png)  <!-- .element: style="object-fit: contain;" -->

;VS;
<!-- .slide: id="37dae74b8aca" -->
 

![ui-lib](assets/images/angular-schematics/ui-lib.png)  <!-- .element: style="height: 500px; object-fit: contain;" -->

;VS;
<!-- .slide: id="8349de64c6b6" -->
 

![nx-gen-lib-1](assets/images/angular-schematics/nx-gen-lib-1.png)  <!-- .element: style="height: 500px;" -->

;VS;
<!-- .slide: id="18a7c243f845" -->
 

index.html__template__

![Template Index](assets/images/angular-schematics/template-index.png)  

;VS;
<!-- .slide: id="b774ba56a76e" -->
 

app.component.html__template__

![Template App HTML](assets/images/angular-schematics/template-app-component-html.png) 
<!-- .element: style="height: 600px;" -->
;VS;
<!-- .slide: id="371b66e07672" -->
 

## But what about styles??

![nx-styles-1](assets/images/angular-schematics/global-styles-1.png)  <!-- .element: style="height: 500px; object-fit: contain;" -->

;VS;
<!-- .slide: id="92ab11717923" -->
 

![nx-styles-2](assets/images/angular-schematics/global-styles-2.png)  <!-- .element: style="height: 500px; object-fit: contain;" -->

;VS;
<!-- .slide: id="920ab3025063" -->
 

![generator-add-styles](assets/images/angular-schematics/generator-add-styles.png)  <!-- .element: style="height: 500px; object-fit: contain;" -->

;VS;
<!-- .slide: id="4715c9517363" -->
 

#### Final Output

![Output](assets/images/angular-schematics/cc-ng-on-changes.png)  <!-- .element: style="position: relative;" -->

;HS;


## But then something happened 😲

;VS;
<!-- .slide: id="55c2a2cfb6bf" -->
 

## Angular Changed their Logo 😱

![Angular New Logo](https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UC-tiSyyd6b2JNaA)
<!-- .element: class="fragment" -->

;VS;
<!-- .slide: id="b6f55713cb25" -->
 

And now I was left with 80+ projects having the harcoded Angular logo (from the generator)

![Template App HTML](assets/images/angular-schematics/template-app-component-html.png) 
<!-- .element: style="height: 600px;" class="fragment" -->
;VS;
<!-- .slide: id="5145de811f72" -->
 

![Facepalm](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExZnY1bTVucnh1NHAxaXA2ZzhjYTBpa2YxdGMweXcwYWNzYTM4eGxsdSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/27EhcDHnlkw1O/giphy.gif) <!-- .element: style="height: 600px" -->

;VS;
<!-- .slide: id="99dffd8758e2" -->
 

### The target was to go from this:

app.component.html__template__
![Template App HTML](assets/images/angular-schematics/template-app-component-html.png) 
<!-- .element: style="height: 600px;" -->

;VS;
<!-- .slide: id="51d6c56abbe5" -->
 

### To this:

app.component.html__template__
![Template App HTML](assets/images/angular-schematics/template-app-component--revised-html.png) 
<!-- .element: style="height: 600px;" -->
;VS;
<!-- .slide: id="0b9592ff7329" -->
 

app.component.ts__template__

![Template App TS](assets/images/angular-schematics/template-app-component-ts.png) 

;VS;
<!-- .slide: id="1975cebd43b3" -->
 

## But it was too late 😔

### I already had created the apps, so I couldn't use the Generators <!-- .element: class="fragment" -->

;VS;
<!-- .slide: id="7f8e81c6675a" -->
 

## What did I do then? 

### What's the solution? <!-- .element: class="fragment" -->

;VS;
<!-- .slide: id="0ce0ce553d63" -->
 

#### First, I created a header component in my library

![ui-lib-2](assets/images/angular-schematics/ui-lib-2.png)  <!-- .element: style="height: 500px; object-fit: contain;" class="fragment" -->

;VS;
<!-- .slide: id="381701e7459b" -->
 

#### Secondly,

![Nx Migrations](assets/images/angular-schematics/nx-migrations.png)

<!-- .element: class="fragment" -->

;VS;
<!-- .slide: id="e6c12a339a6b" -->
 

![Nx Migrations](assets/images/angular-schematics/nx-migrations-2.png)

;VS;
<!-- .slide: id="44145530a6c7" -->
 

I wrote an NX migration script that would replace the toolbars in all the projects

[Replace Toolbar Migration](https://github.com/PacktPublishing/Angular-Cookbook-2E/blob/86ec4ffe5c3fd5d034a0da32893f021b1d889540/codewithahsan/packages/ng-cookbook-recipe/src/migrations/replace-app-toolbar/replace-app-toolbar.ts)

;VS;
<!-- .slide: id="d5c01fc3103e" -->
 

@codewithahsan/packages/ng-cookbook-recipe/migrations.json
![Migrations Json](assets/images/angular-schematics/migrations-json.png)

;VS;
<!-- .slide: id="c96651bd27bb" -->
 

And finally, after running the migrations, I could replace all the headers

[Commit of replacing migrations](https://github.com/PacktPublishing/Angular-Cookbook-2E/commit/48352db45c54783a037aabd8d71c4a61223ddfb7)

;HS;


## But what about Component + TailwindCSS styles?

;VS;
<!-- .slide: id="5769916b3c6a" -->
 

Since I moved my header component to the library, the tailwind styles aren't processed anymore.


![tailwind-styles](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExZ2hiY2M2dmZvczVtZm5lODZhcHRyNXB1YTBnbWFtYzRpNHZiOGIzZiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/gioXyl9A3eiObmtwKZ/giphy.gif)

;VS;
<!-- .slide: id="18607374ab26" -->
 

![tailwind-setup](assets/images/angular-schematics/setup-tailwind.png)

;VS;
<!-- .slide: id="31dad9e016cd" -->
 

![tailwind-setup-2](assets/images/angular-schematics/setup-tailwind-2.png) <!-- .element: style="height: 600px; object-fit: contain;" -->

;VS;
<!-- .slide: id="d7af6b894b7e" -->
 

And [this](https://packtpublishing.github.io/Angular-Cookbook-2E/chapter09/ng-cdk-drag-drop/final/#folders-list) is the final result

;HS;
<!-- .slide: id="8da2b1540013" -->
 

## Summary

- We moved from having 80+ projects to having 2 projects <!-- .element: class="fragment" -->
- We discussed using NX Generators to scaffold projects  <!-- .element: class="fragment" -->
- We also discussed NX Executors to do some modifications to the generated code.  <!-- .element: class="fragment" -->
- We discussed how to use global styles in multiple scaffolded applications using NX Generators.
<!-- .element: class="fragment" -->
- We discussed how to compile tailwind css styles in a library.
<!-- .element: class="fragment" -->
;HS;
<!-- .slide: id="fbf31d5900e3" -->
 

## Thank you!

<div class="introduction">
  <div class="introduction__left">
    <img class="introduction__left__avatar" src="https://avatars.githubusercontent.com/u/9844254?v=4"/>
    <div class="introduction__left__info">
      <p>Muhammad Ahsan Ayaz</p>
      <p>GDE in Angular</p>
      <p>Software Architect at Scania Group</p>
      <p>Founder at VisionWise</p>
    </div>
  </div>
  <div class="introduction__right">
    <img class="introduction__right__ng-book"  src="https://ng-cookbook.com/assets/ng-cookbook-2.png"/>
  </div>
</div>

<div class="footer">
  <div class="footer__site">
    <a href="https://codewithahsan.dev/ng-book">https://codewithahsan.dev/ng-book</a>
  </div>
  <div>
    <a href="https://twitter.com/codewithahsan">@codewith_ahsan</a>
  </div>
</div>